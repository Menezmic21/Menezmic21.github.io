<!DOCTYPE html>
<html class="js no-touch  progressive-image  no-reduced-motion progressive" lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="icon" href="/img/favicon.ico">

    <meta name="keyword" content=""><meta property="og:url" content="//localhost:1313/posts/optima_lab_twist/">
  <meta property="og:site_name" content="Michael Menezes">
  <meta property="og:title" content="OptimaLab: Transformer with Independent Subnetwork Training">
  <meta property="og:description" content="Applied IST techniques to efficiently train transformer architectures in a distributed scenario">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-02-13T12:00:00+00:00">
    <meta property="article:modified_time" content="2024-02-13T12:00:00+00:00">
    <meta property="article:tag" content="Code">
    <meta property="article:tag" content="Machine Learning">
    <meta property="article:tag" content="Research">
<title>OptimaLab: Transformer with Independent Subnetwork Training</title>

    <link rel="canonical" href="//localhost:1313/posts/optima_lab_twist/">

    <link rel="stylesheet" href="/css/global.css">

    <link rel="stylesheet" href="/css/custom.css">

    <link rel="stylesheet" href="/css/search.css" />

    
    

    
    

</head>
    
      <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath: [['\\(', '\\)']]                  
    }
  };
</script>
    
  </head>
  <body class=" page-article   ">
    <header>
      <nav class="nav">
  <div class="nav-wrapper">
    <div class="nav-content-wrapper">
      <div class="nav-content">
        <a href="/ " class="nav-title">Michael Menezes</a>
        <div class="nav-menu">
          <div class="nav-item-wrapper">
            <a href="/posts " class="nav-item-content">Projects</a>
          </div><div class="nav-item-wrapper">
            <a href="/about" class="nav-item-content">About</a>
          </div><div class="nav-item-wrapper">
            <a href="assets/text/Michael_Menezes_Resume (Fall 24).pdf" class="nav-item-content">Resume</a>
          </div></div>
      </div>
    </div>
  </div>
</nav>

<script>
  function toggleSearchModal(){
    const template = `
    <div class="modal-body">
      <div id="autocomplete" onclick="event.stopPropagation();"></div>
    </div>
    `
    const modal = document.querySelector("#modal-wrapper")
    if(!modal){
      const div = document.createElement("div")
      document.body.setAttribute("style","overflow: hidden;")
      div.setAttribute("id", "modal-wrapper")
      div.setAttribute("onclick", "toggleSearchModal()")
      div.innerHTML = template
      const script = document.createElement("script");script.setAttribute("src", "//localhost:1313/js/algolia.js")
      div.appendChild(script)
      document.body.append(div)
    } else {
      document.body.removeAttribute("style")
      document.body.removeChild(modal)
    }
  }
</script>
    </header>
    
  
  
  <main id="main" class="main">
      <section>
        <article class="article">
          
          <div class=" featured-header ">
            <div class="category component">
              <div class="component-content">
                <div class="category-eyebrow">
                  <span class="category-eyebrow__category category_original">
                    
                      
                        Code
                      
                    
                  </span>
                  <span class="category-eyebrow__date">February 13, 2024</span>
                </div>
              </div>
            </div>
            <div class="pagetitle component">
              <div class="component-content">
                <h1 class="hero-headline">OptimaLab: Transformer with Independent Subnetwork Training</h1>
              </div>
            </div>
            <div class="component  featured-subhead ">
              <div class="component-content">Applied IST techniques to efficiently train transformer architectures in a distributed scenario</div>
            </div>

            <div class="tagssheet component">
              <div class="component-content">
                
                  
                  <a href="/tags/code" class="tag">
                    Code
                  </a>
                
                  
                  <a href="/tags/machine-learning" class="tag">
                    Machine Learning
                  </a>
                
                  
                  <a href="/tags/research" class="tag">
                    Research
                  </a>
                
              </div>
            </div>
          </div>
          
          <div class="pagebody">
            
            
            
            
            
            
            
            
            <p class="component-content component">








<figure class="image component image-fullbleed body-copy-wide nr-scroll-animation nr-scroll-animation--on image-big">  <div class="component-content">
    <div class="image-sharesheet">
      <div class="image image-load image-asset image-7e665873eab7085cf36dcc5e351f0d30" id="lht7e665873eab7085cf36dcc5e351f0d30">
        <picture  class="picture">
          <img class="picture-image" data-src="/assets/images/transformers.png" alt="Transformer architecture"  />
        </picture>
      </div>
    </div>
    <div class="image-description">
      <div class="image-caption">
        Transformer architecture
      </div>
    </div>
  </div>
</figure>
</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p class="component-content component">This research project seeks to evaluate the effectiveness of Independent Subnetwork Training (IST) methods on the Transformer architecture. A transformer is a type of neural network that is often used for natural language processing. Transformers are made up of attention heads which are modules that &ldquo;learn&rdquo; how which &ldquo;words&rdquo; in a sentence are &ldquo;important.&rdquo;</p>
<p class="component-content component">To explain exactly what this research project does, I will first explain machine learning in general. Machine learning tries to develop a mathematical model that can be used to predict a function&rsquo;s output given an input by observing the function&rsquo;s behavior on a subset of inputs. The simplest model is a line: \(y = mx + b\). Training this simple model on a dataset is often called &ldquo;linear regression.&rdquo; To fit our line to a dataset, we take a bath of input data, pass it through the model, see how far off predictions are and adjust the value of \(m\) and \(b\) accordingly. This process is called &ldquo;gradient descent.&rdquo; With multidimensional data, our model becomes \(y = Ax + b\). A neural network is a composition of linear and non-linear functions. Simply composing linear functions results in a linear function which isn&rsquo;t capable of capturing the relationships found in non-linear data.</p>
<p class="component-content component">A transformer is a specific type of large matrix-vector function. Transformer with Independent Subnetwork Training (TwIST) tries to take the matrices in the model, partition them into smaller matrices, arranging the smaller matrices into subnetworks, training the subnetworks in parallel on separate GPUs, and recombining the subnetworks back into the large original network. We hope that TwIST will provide a fast method to train large models on small devices.</p>

<div class="component-content pagebody component">
  <h1 id="what-i-did" class="pagebody-header">
    What I did
  </h1>
</div><p class="component-content component">I carried on Chen&rsquo;s work by taking his algorithm and implementing it. Chen orginally made a proof-of-concept by simulating the process of creating subnetworks and communicating them to the GPUs by copying the full model to each GPU and masking parameters locally. In contrast, I wrote the code to actually carry out the algorithm at the system level. This included writing the partitioning code and communication code.</p>
<p class="component-content component">The partitioning code is pretty interesting in that to ensure that attention heads were roughly evenly distributed among the workers (GPUs), I formulated the algorithm as a statistics problem. We have \(n\) hats (GPUs) and we have \(k\) colors of balls (unique attention heads). Each hat has a quota of \(m\). We want to place the balls into the hats such that no two balls of the same color are in the same hat and that together the hats have all the colors. To do this, we line up the hats in a circle, placing balls one-by-one in each hat rotating through the colors. Now, we have ensured that together the hats contain all the colors. Next, we simply fill up the rest of the hat by taking the colors not currently in the hat and randomly selecting the remaining.</p>
<p class="component-content component">The communication code is less interesting but was very complex to implement as the transformer architecture is a complicated one.</p>

<div class="component-content pagebody component">
  <h1 id="what-i-used" class="pagebody-header">
    What I used
  </h1>
</div><p class="component-content component">I used Python with Pytorch for implementing the algorithm, Bash for executing the scripts, and Python Plotly for visualizing the results.</p>

<div class="component-content pagebody component">
  <h1 id="challenges" class="pagebody-header">
    Challenges
  </h1>
</div><p class="component-content component">This research has helped develop my capabilities to work on and understand large codebases. When I first got on the project, the codebase was wildly underdoccumetated and it was difficult to figure out what it was trying to do. The sheer scale of the codebase helped me understand the importance of writing clear code, choosing intuitive variable names, and adding documentation to every function.</p>

          </div><div class="component">
            <div class="component-content">
              <div class="article-copyright">
                <p class="content">
                  Copyright: <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed" target="_blank">Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)</a>
                </p>
                <p class="content">Author:  Chen Dun, Tasos Kyrillidis, Michael Menezes, Hamza Shili, Barbara Su </p>
                <p class="content">Posted on:  February 13, 2024</p>
              </div>
            </div>
          </div></article>
      </section>
  </main>

  <script>
    var script = document.createElement("script");script.src = "//localhost:1313/js/initPost.js";
    document.head.appendChild(script);
  </script>

    
    <div class="footer-main ">
  <div class="content-body footer-wraper">
    <div class="footer-box">
      <div class="foot-nav">
        <div class="foot-nav-items">
          <div class="item">
            <div class="logo"></div>
            <div class="email">Email: <a href="mailto:mnm5@rice.edu">mnm5@rice.edu</a></div>
          </div>

          <div class="item community">
            <div class="item-title">Social Media</div>
            
              <a href="https://www.linkedin.com/in/michaelmenezes21/" target="_blank">LinkedIn</a>
            
          </div>

          <div class="item resources">
            <div class="item-title">Related</div>
            
              <a href="https://github.com/menezmic21" target="_blank">Github</a>
            
          </div>
        </div>
      </div>
      <div class="bottom">
        <div class="item copyright">
          &copy; 2024
          Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> & <a href="https://github.com/floyd-li/hugo-theme-itheme" target="_blank">iTheme</a>
        </div>
      </div>
    </div>
  </div>
</div>

  </body>
    
    

    
    
</html>
